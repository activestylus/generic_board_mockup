/*!
 * jCarousel v@VERSION - Riding carousels with jQuery
 * http://sorgalla.com/jcarousel/
 *
 * Copyright 2011, Jan Sorgalla
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * or GPL Version 2 (http://www.opensource.org/licenses/gpl-2.0.php) licenses.
 *
 * Date: @DATE
 */
(function(e,g){var b=function(j){return parseFloat(j)||0};var a=Array.prototype.slice;var c={};c.version="@VERSION";c.error=function(j){throw new Error(j)};c.noop=function(){};c.proxy=function(l,k){var j=a.call(arguments,2);return function(){return l.apply(k,j.concat(a.call(arguments)))}};c.clone=function(k){if(e.isFunction(k.clone)){return k.clone(true)}var j=e();k.each(function(){j=j.add(this.cloneNode(true))});return j};c.innerWidth=function(j){return b(j.css("width"))+b(j.css("padding-left"))+b(j.css("padding-right"))};c.innerHeight=function(j){return b(j.css("height"))+b(j.css("padding-top"))+b(j.css("padding-bottom"))};c.outerWidth=function(j){return c.innerWidth(j)+b(j.css("margin-left"))+b(j.css("margin-right"))+b(j.css("border-left-width"))+b(j.css("border-right-width"))};c.outerHeight=function(j){return c.innerHeight(j)+b(j.css("margin-top"))+b(j.css("margin-bottom"))+b(j.css("border-top-width"))+b(j.css("border-bottom-width"))};var i=/^(?:body|html)$/i;c.position=function(k){var l=k.get(0).offsetParent||g.document.body;while(l&&(!i.test(l.nodeName)&&e(l).css("position")==="static")){l=l.offsetParent}l=e(l);var m=k.offset(),j=i.test(l[0].nodeName)?{top:0,left:0}:l.offset();m.top-=b(k.css("margin-top"));m.left-=b(k.css("margin-left"));j.top+=b(l.css("border-top-width"));j.left+=b(l.css("border-left-width"));return{top:m.top-j.top,left:m.left-j.left}};var h=/^([+\-]=)?(.+)$/;c.parseTarget=function(l){var j=false,k=typeof l!=="object"?h.exec(l):null;if(k){l=parseInt(k[2],10)||0;if(k[1]){j=true;if(k[1]==="-="){l*=-1}}}else{if(typeof l!=="object"){l=parseInt(l,10)||0}}return{target:l,relative:j}};c.detectCarousel=function(j){var k=j.data("jcarousel"),l=function(m){var n;m.find(".jcarousel").each(function(){n=e(this).data("jcarousel");if(n){return false}});return n};if(!k){while(j.size()>0){k=l(j);if(k){break}j=j.parent()}}return k};c.Plugin={version:c.version,options:{},pluginName:null,pluginClass:null,pluginFn:null,_element:null,_carousel:null,_options:c.noop,_init:c.noop,_destroy:c.noop,_create:function(){this.carousel()._bind("destroy."+this.pluginName,c.proxy(this.destroy,this))},destroy:function(){this._destroy();this.carousel()._unbind("."+this.pluginName).element().unbind("."+this.pluginName);this.element().unbind("."+this.pluginName).removeData(this.pluginName);return this},element:function(){return this._element},option:function(j,k){if(arguments.length===0){return e.extend({},this.options)}if(typeof j==="string"){if(typeof k==="undefined"){return typeof this.options[j]==="undefined"?null:this.options[j]}this.options[j]=k}else{if(e.isFunction(j)){j=j.call(this)}this.options=e.extend({},this.options,j)}return this},carousel:function(){if(!!this.options.carousel){return this.options.carousel.jquery?this.options.carousel.data("jcarousel"):this.options.carousel}if(!this._carousel){this._carousel=c.detectCarousel(this.element());if(!this._carousel){c.error('Could not detect carousel for plugin "'+this.pluginName+'"')}}return this._carousel},_bind:function(l,k,j){(j||this.element()).bind(this.pluginName+l,k);return this},_unbind:function(l,k,j){(j||this.element()).unbind(this.pluginName+l,k);return this},_trigger:function(k,j,m){var l=e.Event((this.pluginName+k).toLowerCase());m=[this].concat(m||[]);(j||this.element()).trigger(l,m);return !(e.isFunction(l.isDefaultPrevented)?l.isDefaultPrevented():l.defaultPrevented)}};var d={};c.plugin=function(j,o){if(typeof o==="undefined"){if(typeof d[j]==="undefined"){return c.error('No such plugin "'+j+'" registered')}return d[j].call(c,e)}d[j]=o;var m,k,n;if(j!=="jcarousel"){m="jcarousel"+j.toLowerCase();k="jcarousel-"+j.toLowerCase();n="jcarousel"+j.charAt(0).toUpperCase()+j.slice(1)}else{m=k=n=j}var l=function(q,p){if(!this._init){return new l(q,p)}this._element=e(q).data(m,this).addClass(k);this.options=e.extend({},this.options,this._options(),p);this._create();this._init()};l.prototype=e.extend({},c.Plugin,{pluginName:m,pluginClass:k,pluginFn:n},o.call(c,e));e.fn[n]=function(q){var p=a.call(arguments,1),r=this;if(typeof q==="string"){this.each(function(){var s=e(this).data(m);if(!s){return c.error("Cannot call methods on "+n+' prior to initialization; attempted to call method "'+q+'"')}if(!e.isFunction(s[q])||q.charAt(0)==="_"){return c.error('No such method "'+q+'" for '+n+" instance")}var t=s[q].apply(s,p);if(t!==s&&typeof t!=="undefined"){r=t;return false}})}else{this.each(function(){var s=e(this).data(m);if(s){if(q){s.option(q)}}else{l(this,q)}})}return r};return l};var f=g.jCarousel;c.noConflict=function(){g.jCarousel=f;return c};g.jCarousel=c;c.plugin("jcarousel",function(k){var j=this;return{options:{list:"ul",items:"li",animation:400,wrap:null,vertical:null,rtl:null,center:false},animating:false,tail:0,inTail:false,resizeTimer:null,lt:null,vertical:false,rtl:false,circular:false,_list:null,_items:null,_target:null,_first:null,_last:null,_visible:null,_fullyvisible:null,_create:function(){},_init:function(){if(false===this._trigger("init")){return this}this._reload();var l=this;this.onWindowResize=function(){if(l.resizeTimer){clearTimeout(l.resizeTimer)}l.resizeTimer=setTimeout(function(){l.reload()},100)};k(g).bind("resize.jcarousel",this.onWindowResize);this.onAnimationComplete=function(n){l.animating=false;var m=l.list().find(".jcarousel-clone");if(m.size()>0){m.remove();l._reload()}l._trigger("animateEnd");if(k.isFunction(n)){n.call(l,true)}};this._trigger("initEnd");return this},destroy:function(){if(false===this._trigger("destroy")){return this}this.element().unbind("."+this.pluginName).removeData(this.pluginName);this.items().unbind(".jcarousel");k(g).unbind("resize.jcarousel",this.onWindowResize);this._trigger("destroyend");return this},reload:function(){if(false===this._trigger("reload")){return this}this._reload();this._trigger("reloadEnd");return this},list:function(){if(this._list===null){var l=this.option("list");this._list=k.isFunction(l)?l.call(this):this.element().find(l)}return this._list},items:function(){if(this._items===null){var l=this.option("items");this._items=(k.isFunction(l)?l.call(this):this.list().find(l)).not(".jcarousel-clone")}return this._items},target:function(){return this._target},first:function(){return this._first},last:function(){return this._last},visible:function(){return this._visible},fullyvisible:function(){return this._fullyvisible},hasNext:function(){var m=this.option("wrap"),l=this.items().size()-1;return l>=0&&((m&&m!=="first")||(this._last.index()<l)||(this.tail&&!this.inTail))?true:false},hasPrev:function(){var l=this.option("wrap");return this.items().size()>0&&((l&&l!=="last")||(this._first.index()>0)||(this.tail&&this.inTail))?true:false},scroll:function(s,l,w){if(this.animating){return this}if(false===this._trigger("scroll",null,[s,l])){return this}if(k.isFunction(l)){w=l;l=true}var t=j.parseTarget(s);if(t.relative){var m=this.items().size()-1,u=Math.abs(t.target),q,r,x,o;if(t.target>0){var v=this._last.index();if(v>=m&&this.tail){if(!this.inTail){this._scrollTail(l,w)}else{if(this.options.wrap=="both"||this.options.wrap=="last"){this._scroll(0,l,w)}else{this._scroll(Math.min(this._target.index()+u,m),l,w)}}}else{if(v===m&&(this.options.wrap=="both"||this.options.wrap=="last")){this._scroll(0,l,w)}else{q=this._target.index();r=q+u;if(this.circular&&r>m){o=m;x=this.items().get(-1);while(o++<r){x=this.items().eq(0);x.after(j.clone(x).addClass("jcarousel-clone"));this.list().append(x);this._items=null}this._scroll(x,l,w)}else{this._scroll(Math.min(r,m),l,w)}}}}else{if(this.inTail){this._scroll(Math.max((this._first.index()-u)+1,0),l,w)}else{q=this._first.index();r=q-u;if(q===0&&(this.options.wrap=="both"||this.options.wrap=="first")){this._scroll(m,l,w)}else{if(this.circular&&r<0){o=r;x=this.items().get(0);while(o++<0){x=this.items().eq(-1);x.after(j.clone(x).addClass("jcarousel-clone"));this.list().prepend(x);this._items=null;var n=b(this.list().css(this.lt)),p=this._dimension(x);this.rtl?n+=p:n-=p;this.list().css(this.lt,n+"px")}this._scroll(x,l,w)}else{this._scroll(Math.max(q-u,0),l,w)}}}}}else{this._scroll(t.target,l,w)}this._trigger("scrollend");return this},_reload:function(){var l=this.element(),n=function(){if((""+l.attr("dir")).toLowerCase()==="rtl"){return true}var o=false;l.parents("[dir]").each(function(){if((/rtl/i).test(k(this).attr("dir"))){o=true;return false}});return o};this.vertical=this.options.vertical==null?(""+l.attr("class")).toLowerCase().indexOf("jcarousel-vertical")>-1:this.options.vertical;this.rtl=this.options.rtl==null?n():this.options.rtl;this.lt=this.vertical?"top":"left";this._items=null;var m=this._target||this.items().eq(0);this.circular=this.options.wrap=="circular";this.list().css({left:0,top:0});if(m.size()>0){this._prepare(m);this.list().find(".jcarousel-clone").remove();this._items=null;this.circular=this.options.wrap=="circular"&&this._fullyvisible.size()<this.items().size();this.list().css(this.lt,this._position(m)+"px")}return this},_scroll:function(n,l,q){if(this.animating){return this}if(typeof n!=="object"){n=this.items().eq(n)}else{if(typeof n.jquery==="undefined"){n=k(n)}}if(n.size()===0){if(k.isFunction(q)){q.call(this,false)}return this}this.inTail=false;this._prepare(n);var p=this._position(n),o=b(this.list().css(this.lt));if(p===o){if(k.isFunction(q)){q.call(this,false)}return this}var m={};m[this.lt]=p+"px";this._animate(m,l,q);return this},_scrollTail:function(l,o){if(this.animating||!this.tail){return this}var n=j.position(this.list())[this.lt];this.rtl?n+=this.tail:n-=this.tail;this.inTail=true;var m={};m[this.lt]=n+"px";this._update({target:this._target.next(),fullyvisible:this._fullyvisible.slice(1).add(this._visible.last())});this._animate(m,l,o);return this},_animate:function(n,m,q){if(this.animating){return this}if(false===this._trigger("animate")){return this}this.animating=true;if(!this.options.animation||m===false){this.list().css(n);this.onAnimationComplete(q)}else{var l=this;if(k.isFunction(this.options.animation)){this.options.animation.call(this,n,function(){l.onAnimationComplete(q)})}else{var p=typeof this.options.animation==="object"?this.options.animation:{duration:this.options.animation},o=p.complete;p.complete=function(){l.onAnimationComplete(q);if(k.isFunction(o)){o.call(this)}};this.list().animate(n,p)}}return this},_prepare:function(s){var q=s.index(),r=q,l=this._dimension(s),m=this._clipping(),o={target:s,first:s,last:s,visible:s,fullyvisible:l<=m?s:k()},p=this.vertical?"bottom":(this.rtl?"left":"right"),t,n;if(this.options.center){l/=2;m/=2}if(l<m){while(true){t=this.items().eq(++r);if(t.size()===0){if(this.circular){t=this.items().eq(0);if(s.get(0)===t.get(0)){break}t.after(j.clone(t).addClass("jcarousel-clone"));this.list().append(t);this._items=null}else{break}}l+=this._dimension(t);o.last=t;o.visible=o.visible.add(t);n=b(t.css("margin-"+p));if((l-n)<=m){o.fullyvisible=o.fullyvisible.add(t)}if(l>=m){break}}}if(!this.circular&&l<m){r=q;while(true){if(--r<0){break}t=this.items().eq(r);if(t.size()===0){break}l+=this._dimension(t);o.first=t;o.visible=o.visible.add(t);n=b(t.css("margin-"+p));if((l-n)<=m){o.fullyvisible=o.fullyvisible.add(t)}if(l>=m){break}}}this._update(o);this.tail=0;if(this.options.wrap!=="circular"&&this.options.wrap!=="custom"&&o.last.index()===(this.items().size()-1)){l-=b(o.last.css("margin-"+p));if(l>m){this.tail=l-m}}return this},_position:function(l){var m=this._first,n=j.position(m)[this.lt];if(this.rtl&&!this.vertical){n-=this._clipping()-this._dimension(m)}if(this.options.center){n-=(this._clipping()/2)-(this._dimension(m)/2)}if((l.index()>m.index()||this.inTail)&&this.tail){n=this.rtl?n-this.tail:n+this.tail;this.inTail=true}else{this.inTail=false}return -n},_update:function(q){var m=this,o={target:this._target||k(),first:this._first||k(),last:this._last||k(),visible:this._visible||k(),fullyvisible:this._fullyvisible||k()},l=(q.first||o.first).index()<o.first.index(),n,p=function(s){var r=[],t=[];q[s].each(function(){if(o[s].index(this)<0){r.push(this)}});o[s].each(function(){if(q[s].index(this)<0){t.push(this)}});if(l){r=r.reverse()}else{t=t.reverse()}m._trigger("item"+s+"in",k(r));m._trigger("item"+s+"out",k(t));o[s].removeClass("jcarousel-item-"+s);q[s].addClass("jcarousel-item-"+s);m["_"+s]=q[s]};for(n in q){p(n)}return this},_clipping:function(){return j["inner"+(this.vertical?"Height":"Width")](this.element())},_dimension:function(l){return j["outer"+(this.vertical?"Height":"Width")](l)}}})})(window.jQuery||window.Zepto,window);